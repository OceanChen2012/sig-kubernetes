---
draft: false
profile: 华北电力大学大四学生。
keywords:
  - Kubernetes
  - APIServer
author: '[杨鼎睿](https://yuque.com/abser)'
date: '2021-05-06T17:04:05.000Z'
title: Kubernetes APIServer Generic API Server 架构设计源码阅读
tags:
  - Kubernetes
  - 源码架构图
  - APIServer
avatar: /images/profile/abserari.png
type: post
image: /images/blog/kubernetes-apiserver.png
categories:
  - kubernetes
description: '本文研究了 Generic API Server 部分的源码，配备源码进行进一步理解，可以加深理解,增强相关设计能力。'
---

# API Server Generic API Server

This article has studied the source code of the Generic API Server part, equipped with the source code for further understanding, which can deepen the understanding and enhance related design capabilities.

## Delegation Chain

### Overview

![generic-api-server.svg](../.gitbook/assets/54%20%281%29.png)

### Server Chain

![generic-api-server-server-chain.svg](../.gitbook/assets/55%20%281%29.png)

## HTTP Server

### Handler Chain

The type of HandlerChainBuilderFn is defined as follows. Pass in an http.Handler instance and return an http.Handler instance. In this way, a middleware-like effect can be achieved.

![image.png](../.gitbook/assets/56%20%281%29.png)

When creating the ApiServerHandler, use the following method.

![image.png](../.gitbook/assets/57%20%281%29.png)

### Start

The final startup code of preparedAPIAggregator is as follows. It simply calls the Run method of runnable. In Server Chain, we know that runnable is an instance of preparedGenericAPIServer generated by GenericAPIServer included in APIAggregator.

![image.png](../.gitbook/assets/58%20%281%29.png)

The Run method of PreparedGenericapiServer is as follows.

![image.png](../.gitbook/assets/59.png)

